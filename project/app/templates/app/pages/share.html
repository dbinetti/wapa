{% extends 'app/pages/base.html' %}

{% load bootstrap4 %}
{% load app_tags %}

{% comment %}
{% block formmedia %}
  {{ form.media }}
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v10.0&appId=286973936371350&autoLogAppEvents=1" nonce="BVurEf1h"></script>
{% endblock formmedia %}
{% endcomment %}

{% block title %}Sharing{% endblock title %}

{% block content %}
  <section class='mt-5'>
    <h2 class='my-3 col-md-12'>
      Sharing
    </h2>
    <p class='lead my-3 col-md-12'>
      Please share this site because we need more support!
    </p>
    <div class='my-5 ml-3 col-md-12'>
      <div class='row my-5'>
        <div class='col-sm-2'>
          Facebook Share:
        </div>
        {% comment %}
        <div class="fb-share-button col-sm-3" data-href="https://www.westadaparents.com" data-layout="button_count" data-size="large"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.westadaparents.com%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>
        {% endcomment %}
      </div>
      <div class='row my-5'>
        <div class='col-sm-2'>
          Text Share:
        </div>
        <div class='col-sm-10'>
          {% bootstrap_button "Share via Text" id='textbutton' button_type='button' button_class='btn btn-primary btn-sm' %}
        </div>
      </div>
      <div class='row my-5'>
        <div class='col-sm-2'>
          Copy/Paste:
        </div>
        <div class='col-sm-10'>
          <span>https://www.westadaparents.com</span>
        </div>
      </div>
    </div>
    <p class='lead col-md-8 my-5'>
      Lastly, If you need any other help, please don't hesitate to reach out at <a href='mailto:dbinetti@westadaparents.com'>dbinetti@westadaparents.com</a>.
    </p>
    <h4>
      Thanks for supporting our kids!
    </h4>
    <p class='my-5'>
      (Back to your <a href='{% url "account" %}'>Account Details</a>)
    </p>
  </section>
{% endblock content %}

{% block postbody %}
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId            : '{% get_env_var "FACEBOOK_CLIENT_ID" %}',
        autoLogAppEvents : true,
        xfbml            : true,
        version          : 'v11.0'
      });
      FB.ui({
        method: 'share',
        href: 'https://developers.facebook.com/docs/'
      }, function(response){});
    };
  </script>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
  <script>
  </script>
{% endblock %}

{% block scripts %}
  <script>
    const toShare = {
      title: "West Ada Parents!",
      text: "Please help us support the Superintendent and keep kids smiling in school!",
      url: "https://www.westadaparents.com"
    };
    const button = document.querySelector('#textbutton');
    button.addEventListener('click', async () => {
      try {
        await navigator.share(toShare); // Will trigger the native "share" feature
        button.textContent = 'Thank You -- Share Again!';
      }
      catch(err) {
        button.textContent = 'Something went wrong:  copy and paste the URL below';
      }
    });
  </script>
{% endblock scripts %}

