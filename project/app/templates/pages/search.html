{% extends '_base.html' %}

{% block content %}
  <form autocomplete="off">
    <input type="text" name="q" id="q" onKeyUp="showResults(this.value)" />
    <div id="result"></div>
  </form>
{% endblock content %}

{% block scripts %}
  <script>
    function showResults(val) {
      res = document.getElementById("result");
      res.innerHTML = '';
      if (val == '') {
        return;
      }
      let list = '';
      fetch('http://localhost:8080/search?q=' + val).then(
       function (response) {
         return response.json();
       }).then(function (data) {
        console.log(data.results);
         for (i=0; i<data.results.length; i++) {
           list += '<li><a href=' + data.results[i].url +  '>'  + data.results[i].name + '</a></li>';
         }
         res.innerHTML = '<ul>' + list + '</ul>';
         return true;
       }).catch(function (err) {
         console.warn('Something went wrong.', err);
         return false;
       });
    }
  </script>
{% endblock scripts %}